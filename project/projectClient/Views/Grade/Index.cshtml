@addTagHelper *,Microsoft.AspNetCore.Mvc.TagHelpers
@using projectClient.DTO;
@model ScoreExamResultDTO
@if (@TempData["Message"] != null)
{
    <p>@TempData["Message"]</p>
}
<h2>Mark The Exam</h2>
<div class="form-group w-50" >
    <label for="fileInput">Select a .zip file to upload:</label>
    <input type="file" class="form-control" id="fileInput" accept=".zip" />
</div>


<div class="form-group">
    <label for="examId">Select an exam:</label>
    <select name="exam" id="examId" class="form-control">
        @foreach (var a in ViewBag.exams)
        {
            <option value="@a.ExamId">@a.ExamName</option>
        }
    </select>
</div>
<div class="form-group form-check">
    <input type="checkbox" class="form-check-input" name="type" id="typeTest">
    <label class="form-check-label" for="typeTest">Just Test</label>
</div>

<div class="form-group">
    <input type="submit" value="Submit" class="btn btn-success" id="submitBtn">
</div>

@section Scripts{
    <script>
        $(document).ready(function () {
            $(document).on("click", '#submitBtn', function (event) {
                event.preventDefault();
                //console.log(1);
                var fileInput = document.getElementById("fileInput");
                var examId = document.getElementById("examId").value;
                var typeTest = $('#typeTest').prop('checked') ? 1 : 0;
                console.log(typeTest);
                var formData = new FormData();
                formData.append("file", fileInput.files[0]);
                formData.append("examId", examId);
                formData.append("type", typeTest);


                $.ajax({
                    url: "http://localhost:5000/api/Grade",
                    method: "POST",
                    data: formData,
                    contentType: false,
                    processData: false,
                    success: function (data) {
                        console.log(data);
                        // handle response data
                    },
                    error: function (xhr, status, error) {
                        console.error(error);
                        // handle error
                    }
                });

            });
            
            /*
            $.ajax({
                url: "http://localhost:5000/api/Exam/OData?$filter=paperNo eq 1",
                method: "GET",
                success: function (data) {
                    console.log(data);
                    // handle response data
                },
                error: function (xhr, status, error) {
                    console.error(error);
                    // handle error
                }
            });
            */
        });
    </script>
}